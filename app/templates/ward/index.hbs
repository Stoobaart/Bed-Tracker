<div class="ward-details">
  {{#if this.model.showSuccessMessage}}
    <div class="banner banner--success">
      <div class="banner_title"><img src="/assets/images/success.svg" alt="">COVID beds added successfully</div>
      <p>The beds are ready for patients</p>
      <img src="/assets/images/close.svg" alt="close" class="banner_close" {{on "click" (fn (mut this.model.showSuccessMessage) null)}}>
    </div>
  {{/if}}

  <div class="breadcrumbs">
    <LinkTo @route="dashboard" @tagName="span">
      <img src="/assets/images/hospital.svg" alt="">
      <div class="text">Dashboard</div>
    </LinkTo> > Ward {{this.model.shortName}}
  </div>
  <div class="ward-details_names">
    <div>
      <h1>{{this.model.shortName}}</h1>
      <p>{{this.model.longName}}</p>
    </div>
    <LinkTo @route="ward.edit" @model={{this.model}}>Edit</LinkTo>
  </div>

  <div class="cards-container--wards">
    <div class="card">
      <div class="card_header">
        <img class="card_icon" src="/assets/images/occupied.svg" alt="">
        <div class="card_header-text">WARD TOTAL COVID BEDS  {{this.model.totalBeds}}</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.model.availableBeds}}</div>
        <div class="card_data-block--label">Total available COVID beds</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.availableBedsPercentage}}%</div>
        <div class="card_data-block--label">Total available bed capacity</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.model.totalVentilatorInUse}}</div>
        <div class="card_data-block--label">Total ventilators in use</div>
      </div>
    </div>

    <div class="card">
      <div class="card_header">
        <img class="card_icon" src="/assets/images/covid-19-positive.svg" alt="">
        <div class="card_header-text">TOTAL COVID PATIENT STATS</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.model.totalCovidStatusPositive}}</div>
        <div class="card_data-block--label">Total COVID positive</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.model.totalCovidStatusNegative}}</div>
        <div class="card_data-block--label">Total COVID negative</div>
      </div>

      <div class="card_data-block">
        <div class="card_data-block--value">{{this.model.totalCovidStatusSuspected}}</div>
        <div class="card_data-block--label">Total COVID suspected</div>
      </div>
    </div>
  </div>
</div>

<div class="ward-beds-top-bar">
  <div class="header">COVID beds</div>
  <LinkTo class="link-button" role="button" @route="ward.add-beds" @model={{this.model.id}}>
    <img src="/assets/images/plus.svg" alt="">
    Add beds
  </LinkTo>
</div>

{{#if this.model.beds}}
  <div class="table">
    <div class="header">
      <div class="bed-number"></div>
      <div class="header--column">
        <img class="icon" src="/assets/images/occupied-white.svg" alt="">
        Availability
      </div>
      <div class="header--column">
        <img class="icon" src="/assets/images/covid-19-positive-white.svg" alt="">
        COVID
      </div>
      <div class="header--column">
        <img class="icon" src="/assets/images/white.svg" alt="">
        Ventilation
      </div>
    </div>

    {{#each this.model.beds as |bed index|}}
      <div class="table_card">
        <div class="bed-number">{{plus-one index}}</div>
        {{#if bed.available}}
          <div class="column interactive" role="button" {{on "click" (fn this.openEditBedModal bed index)}}>
            <img class="icon" src="/assets/images/available-yes-green.svg" alt="">
            Available
          </div>
          <div class="column"></div>
          <div class="column"></div>
        {{else}}
          <div class="column interactive" role="button" {{on "click" (fn this.openEditBedModal bed index)}}>
            <img class="icon" src="/assets/images/occupied-off-black.svg" alt="">
            Occupied
          </div>
          <div class="column">
            {{#if (eq bed.covidStatus "POSITIVE")}}
              <img class="icon" src="/assets/images/covid-19-positive-red.svg" alt="">
            {{else if (eq bed.covidStatus "NEGATIVE")}}
              <img class="icon" src="/assets/images/covid-19-negative.svg" alt="">
            {{else if (eq bed.covidStatus "SUSPECTED")}}
              <img class="icon" src="/assets/images/covid-19-suspected-purple.svg" alt="">
            {{/if}}
            {{bed.covidStatus}}
          </div>
          <div class="column">
            {{#if bed.ventilatorInUse}}
              <img class="icon tick" src="/assets/images/off-black.svg" alt="">
              Ventilated
            {{/if}}
          </div>
        {{/if}}
      </div>
    {{/each}}

  </div>
{{/if}}

{{#if this.editBedModalIsOpen}}
  <ModalDialog @onClose={{this.closeModal}} @targetAttachment="center" @attachment="middle" @hasOverlay={{true}}>
    <div class="header">
      {{#if this.showDeleteForm}}
        <img src="/assets/images/delete.svg" alt="">
        Delete bed
      {{else}}
        Change status of bed
      {{/if}}
      {{this.bedInMemory.index}}
      <div class="close-btn" role="button" {{action this.closeModal}}>
        <img src="/assets/images/cross.svg" alt="">
      </div>
    </div>

    {{#if this.showDeleteForm }}
      <form>
        <div class="subheader">Are you sure you want to delete this bed from the ward?</div>

        <div class="btns-container">
          <button
            type="button"
            class="form_btn cancel"
            {{on "click" this.toggleDeleteModal}}>
            Cancel
          </button>

          <button
            type="submit"
            class="form_btn submit"
            {{on "click" this.deleteBed}}>
            Delete
          </button>
        </div>
      </form>
    {{else}}
      <form>
        <div class="subheader">The patient occupying the bed is:</div>

        {{#if this.showPatientPositiveRadio}}
          <div class="radio">
            <input
              id="positive"
              type="radio"
              checked={{eq this.bedInMemory.bed.covidStatus 'POSITIVE'}}
              onclick={{action this.setCovidStatus 'POSITIVE'}}>
            <label for="positive" class="radio--label">
              <div class="radio--text">COVID positive</div>
            </label>
          </div>
        {{/if}}

        {{#if this.showPatientNegativeRadio}}
          <div class="radio">
            <input
              id="negative"
              type="radio"
              checked={{eq this.bedInMemory.bed.covidStatus 'NEGATIVE'}}
              onclick={{action this.setCovidStatus 'NEGATIVE'}}>
            <label for="negative" class="radio--label">
              <div class="radio--text">COVID negative</div>
            </label>
          </div>
        {{/if}}

        {{#if this.showPatientSuspectedRadio}}
          <div class="radio">
            <input
              id="suspected"
              type="radio"
              checked={{eq this.bedInMemory.bed.covidStatus 'SUSPECTED'}}
              onclick={{action this.setCovidStatus 'SUSPECTED'}}>
            <label for="suspected" class="radio--label">
              <div class="radio--text">COVID suspected</div>
            </label>
          </div>
        {{/if}}

        {{#if this.showBedAvailableRadio}}
          <div class="radio">
            <input
              id="make-available"
              type="radio"
              checked={{this.bedInMemory.bed.available}}
              onclick={{action this.setAvailability}}>
            <label for="make-available" class="radio--label">
              <div class="radio--text">This bed is now available</div>
            </label>
          </div>
        {{/if}}



        <div class="radio ventilation">
          <input
            id="ventilation"
            type="checkbox"
            checked={{this.bedInMemory.bed.ventilatorInUse}}
            onclick={{action this.setVentilatorStatus}}>
          <label for="ventilation" class="radio--label">
            <div class="radio--text">Has ventilation</div>
          </label>
        </div>

        <button
          type="submit"
          class="form_btn"
          disabled={{not this.changesMade}}
          {{on "click" this.editBed}}>
          Save changes
        </button>

        <div class="delete-container" role="button" {{on "click" this.toggleDeleteModal}}>
          <img src="/assets/images/delete.svg" alt="">
          <div class="text">Remove bed from this ward</div>
        </div>
      </form>
    {{/if}}

  </ModalDialog>
{{/if}}