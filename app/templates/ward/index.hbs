<div class="ward-details">
  {{#if this.model.showSuccessMessage}}
    <div class="banner banner--success">
      <div class="banner_title"><img src="/assets/images/success.svg" alt="">Beds added successfully</div>
      <p>The beds are ready for patients</p>
      <img src="/assets/images/close.svg" alt="close" class="banner_close"  role="button" {{on "click" (fn (mut this.model.showSuccessMessage) null)}}>
    </div>
  {{/if}}

  <div class="breadcrumbs">
    <LinkTo @route="dashboard" @tagName="span">
      <img src="/assets/images/hospital.svg" alt="">
      <div class="text">Dashboard</div>
    </LinkTo> > Ward {{this.model.name}}
  </div>
  <div class="ward-details_names">
    <div>
      <h1>{{this.model.name}}</h1>
      <p>{{this.model.description}}</p>
    </div>
    <LinkTo @route="ward.edit" @model={{this.model}}>Edit</LinkTo>
  </div>

  <div class="cards-container--wards">
    <div class="card">
      <div class="card_header">
        <img class="card_icon" src="/assets/images/occupied.svg" alt="">
        <div class="card_header-text">WARD TOTAL BEDS  {{this.model.totalBeds}}</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.model.availableBeds}}</div>
        <div class="card_data-block--label">Total available beds</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.availableBedsPercentage}}%</div>
        <div class="card_data-block--label">Total available bed capacity</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.model.totalVentilatorInUse}}</div>
        <div class="card_data-block--label">Total ventilators in use</div>
      </div>
    </div>

    <div class="card">
      <div class="card_header">
        <img class="card_icon" src="/assets/images/covid-19-positive.svg" alt="">
        <div class="card_header-text">TOTAL COVID PATIENT STATS</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.model.totalCovidStatusPositive}}</div>
        <div class="card_data-block--label">Total COVID positive</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.model.totalCovidStatusNegative}}</div>
        <div class="card_data-block--label">Total COVID negative</div>
      </div>

      <div class="card_data-block ward-dashboard">
        <div class="card_data-block--value">{{this.model.totalCovidStatusSuspected}}</div>
        <div class="card_data-block--label">Total COVID suspected</div>
      </div>
    </div>
  </div>
</div>

<div class="ward-beds-top-bar">
  <div class="header">Beds</div>
  <LinkTo class="link-button" role="button" @route="ward.add-beds" @model={{this.model.id}}>
    <img src="/assets/images/plus.svg" alt="">
    Add beds
  </LinkTo>
</div>

{{#if this.model.beds}}
  <div class="table">
    <div class="header">
      <div class="bed-number"></div>
      <div class="header--column availability-1">
        <img class="icon" src="/assets/images/occupied-white.svg" alt="">
      </div>
      <div class="header--column availability-2">
        Availability
      </div>
      <div class="header--column">
        <img class="icon" src="/assets/images/covid-19-positive-white.svg" alt="">
        COVID
      </div>
      <div class="header--column centered">
        Care Level
      </div>
      <div class="header--column centered">
        Ventilation
      </div>
      <div class="header--column centered">
        hemofiltration
      </div>
    </div>

    {{#each this.model.beds as |bed index|}}
      <div class="table_card"  role="button" {{on "click" (fn this.openEditBedModal bed index)}}>
        <div class="bed-number">{{plus-one index}}</div>
        {{#if bed.available}}
          <div class="column availability-1">
            <img class="icon" src="/assets/images/available-yes-green.svg" alt="">
          </div>
          <div class="column availability-2">
            Available
          </div>

          <div class="column"></div>
          <div class="column"></div>
          <div class="column"></div>
          <div class="column"></div>

        {{else}}
          <div class="column availability-1">
            <img class="icon" src="/assets/images/occupied-off-black.svg" alt="">
          </div>
          <div class="column availability-2">
            Occupied
          </div>
          <div class="column">
            {{#if (eq bed.covidStatus "POSITIVE")}}
              <img class="icon" src="/assets/images/covid-19-positive-red.svg" alt="">
            {{else if (eq bed.covidStatus "NEGATIVE")}}
              <img class="icon" src="/assets/images/covid-19-negative.svg" alt="">
            {{else if (eq bed.covidStatus "SUSPECTED")}}
              <img class="icon" src="/assets/images/covid-19-suspected-purple.svg" alt="">
            {{/if}}
            {{bed.covidStatus}}
          </div>
          <div class="column level">
            {{#if (eq bed.levelOfCare 'LEVEL_1')}}
              <div class="text">Level 1</div>
            {{else if (eq bed.levelOfCare 'LEVEL_2')}}
              <div class="text">Level 2</div>
            {{else if (eq bed.levelOfCare 'LEVEL_3')}}
              <div class="text">Level 3</div>
            {{/if}}
          </div>
          <div class="column vent">
            {{#if bed.ventilationType}}
              <div class="text">{{bed.ventilationType}}</div>
            {{else}}
              <div class="text">No</div>
            {{/if}}
          </div>
          <div class="column hemo">
            {{#if bed.hemofilterInUse}}
              <div class="text">Yes</div>
            {{else}}
              <div class="text">No</div>
            {{/if}}
          </div>
        {{/if}}
      </div>
    {{/each}}

  </div>
{{/if}}

{{#if this.editBedModalIsOpen}}
  <ModalDialog @onClose={{this.closeModal}} @targetAttachment="center" @attachment="middle" @hasOverlay={{true}}>
    <div class="header">
      {{#if this.showDeleteForm}}
        <img src="/assets/images/delete.svg" alt="">
        Delete bed
      {{else}}
        Edit bed
      {{/if}}
      {{this.index}}
      <div class="close-btn" role="button" {{action this.closeModal}}>
        <img src="/assets/images/cross.svg" alt="">
      </div>
    </div>

    {{#if this.showDeleteForm }}
      <form>
        <div class="subheader">Are you sure you want to delete this bed from the ward?</div>

        <div class="btns-container">
          <button
            type="button"
            class="form_btn cancel"
            {{on "click" this.toggleDeleteModal}}>
            Cancel
          </button>

          <button
            type="submit"
            class="form_btn submit"
            {{on "click" this.deleteBed}}>
            Delete
          </button>
        </div>
      </form>
    {{else}}
      <form>
        <div class="availability-container">
          <div>Availability</div>
          <div role="button" class="toggle {{if this.available "toggle-on" "toggle-off"}}" {{on "click" setAvailability}}>
            <img src="{{if this.available "/assets/images/toggle-tick.svg" "/assets/images/toggle-cross.svg"}}" alt="">
          </div>
        </div>
        
        {{#if (not this.available)}}
          <section>
            <div class="section-header">
              COVID status:
            </div>
            <div class="radio">
              <input
                id="positive"
                type="radio"
                checked={{eq this.covidStatus "POSITIVE"}}
                onclick={{action this.setCovidStatus "POSITIVE"}}>
              <label for="positive" class="radio--label">
                <div class="radio--text">COVID positive</div>
              </label>
            </div>

            <div class="radio">
              <input
                id="negative"
                type="radio"
                checked={{eq this.covidStatus "NEGATIVE"}}
                onclick={{action this.setCovidStatus "NEGATIVE"}}>
              <label for="negative" class="radio--label">
                <div class="radio--text">COVID negative</div>
              </label>
            </div>

            <div class="radio third">
              <input
                id="suspected"
                type="radio"
                checked={{eq this.covidStatus "SUSPECTED"}}
                onclick={{action this.setCovidStatus "SUSPECTED"}}>
              <label for="suspected" class="radio--label">
                <div class="radio--text">COVID suspected</div>
              </label>
            </div>
          </section>

          <section>
            <div class="section-header">
              Level of care:
            </div>
            <div class="radio">
              <input
                id="level-1"
                type="radio"
                checked={{eq this.levelOfCare "LEVEL_1"}}
                onclick={{action this.setLevelOfCare "LEVEL_1"}}>
              <label for="level-1" class="radio--label">
                <div class="radio--text">Level 1</div>
              </label>
            </div>

            <div class="radio">
              <input
                id="level-2"
                type="radio"
                checked={{eq this.levelOfCare "LEVEL_2"}}
                onclick={{action this.setLevelOfCare "LEVEL_2"}}>
              <label for="level-2" class="radio--label">
                <div class="radio--text">Level 2</div>
              </label>
            </div>

            <div class="radio third">
              <input
                id="level-3"
                type="radio"
                checked={{eq this.levelOfCare "LEVEL_3"}}
                onclick={{action this.setLevelOfCare "LEVEL_3"}}>
              <label for="level-3" class="radio--label">
                <div class="radio--text">Level 3</div>
              </label>
            </div>
          </section>

          <section>
            <div class="section-header">
              Ventilation:
            </div>

            <div class="radio">
              <input
                id="no-ventilation"
                type="radio"
                checked={{eq this.ventilationType null}}
                onclick={{action this.setVentilationType null}}>
              <label for="no-ventilation" class="radio--label">
                <div class="radio--text">No ventilation</div>
              </label>
            </div>

            <div class="radio">
              <input
                id="sv"
                type="radio"
                checked={{eq this.ventilationType "SV"}}
                onclick={{action this.setVentilationType "SV"}}>
              <label for="sv" class="radio--label">
                <div class="radio--text">SV</div>
              </label>
            </div>

            <div class="radio third">
              <input
                id="niv"
                type="radio"
                checked={{eq this.ventilationType "NIV"}}
                onclick={{action this.setVentilationType "NIV"}}>
              <label for="niv" class="radio--label">
                <div class="radio--text">NIV</div>
              </label>
            </div>

            <div class="radio fourth">
              <input
                id="intubated"
                type="radio"
                checked={{eq this.ventilationType "INTUBATED"}}
                onclick={{action this.setVentilationType "INTUBATED"}}>
              <label for="intubated" class="radio--label">
                <div class="radio--text">INTUBATED</div>
              </label>
            </div>
          </section>

          <div class="radio hemofiltration">
            <input
              id="hemofiltration"
              type="checkbox"
              checked={{false}}
              onclick={{action this.setHemofilterInUse}}>
            <label for="hemofiltration" class="radio--label">
              <div class="radio--text">Using hemofiltration</div>
            </label>
          </div>
        {{/if}}

        <button
          type="submit"
          class="form_btn"
          disabled={{not this.changesMade}}
          {{on "click" this.editBed}}>
          Save changes
        </button>

        <div class="delete-container" role="button" {{on "click" this.toggleDeleteModal}}>
          <img src="/assets/images/delete.svg" alt="">
          <div class="text">Remove bed from this ward</div>
        </div>
      </form>
    {{/if}}

  </ModalDialog>
{{/if}}